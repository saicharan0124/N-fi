{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Web3Auth = void 0;\n\nvar _ethers = require(\"ethers\");\n\nvar _verifyChainId = _interopRequireDefault(require(\"../utils/verifyChainId\"));\n\nvar _AbstractWeb3Connector = _interopRequireDefault(require(\"./AbstractWeb3Connector\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nclass Web3Auth extends _AbstractWeb3Connector.default {\n  constructor() {\n    var _this;\n\n    super(...arguments);\n    _this = this;\n\n    _defineProperty(this, \"type\", 'web3Auth');\n\n    _defineProperty(this, \"connect\", web3auth => {\n      return new Promise((resolve, reject) => {\n        (web3auth => {\n          web3auth.loginModal.on('MODAL_VISIBILITY', async visibility => {\n            if (!visibility) {\n              reject(new Error('Web3Auth: User closed login modal.'));\n            }\n          });\n        })(web3auth);\n\n        web3auth.connect().then(resolve).catch(reject);\n      });\n    });\n\n    _defineProperty(this, \"activate\", async function () {\n      let {\n        chainId = '0x1',\n        clientId,\n        theme,\n        appLogo,\n        loginMethodsOrder\n      } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      // Checking that all params are given\n      if (!clientId) {\n        throw new Error('\"clientId\" not provided, please provide clientId');\n      } // Initalizing Web3Auth and getting constants\n\n\n      let Web3Auth;\n\n      try {\n        var _require;\n\n        Web3Auth = (_require = require('@web3auth/web3auth')) === null || _require === void 0 ? void 0 : _require.Web3Auth;\n      } catch (_unused) {// Do Nothing Individual Checks are done below\n      } // Check if user is using CDN to import\n\n\n      if (!Web3Auth) {\n        var _window, _window$Web3auth;\n\n        Web3Auth = (_window = window) === null || _window === void 0 ? void 0 : (_window$Web3auth = _window.Web3auth) === null || _window$Web3auth === void 0 ? void 0 : _window$Web3auth.Web3Auth;\n      } // Error checking for if library is not installed\n\n\n      if (!Web3Auth) {\n        throw new Error('\"@web3auth/web3auth\" not installed, please install');\n      } // Build config\n\n\n      const ethChainConfig = {\n        chainNamespace: 'eip155',\n        chainId: (0, _verifyChainId.default)(chainId)\n      }; // Build Web3Auth\n\n      let web3auth;\n\n      try {\n        web3auth = new Web3Auth({\n          chainConfig: ethChainConfig,\n          uiConfig: {\n            theme: theme !== null && theme !== void 0 ? theme : 'dark',\n            appLogo: appLogo !== null && appLogo !== void 0 ? appLogo : 'https://moralis.io/wp-content/uploads/2021/05/moralisWhiteLogo.svg',\n            loginMethodsOrder\n          },\n          clientId: clientId\n        });\n      } catch (_unused2) {// Do Nothing error checked below\n      }\n\n      if (!web3auth) {\n        throw new Error('Could not connect via Web3Auth, error during initializing Web3Auth');\n      } // Authenticate\n\n\n      await web3auth.initModal();\n      let provider = null;\n      provider = await _this.connect(web3auth);\n\n      if (!provider) {\n        throw new Error('Could not connect via Web3Auth, error in connecting to provider');\n      } // Gather User data\n\n\n      try {\n        var _web3auth, _web3auth2, _web3auth3;\n\n        const isSocialLogin = (_web3auth = web3auth) !== null && _web3auth !== void 0 && _web3auth.provider ? false : true;\n        const ether = new _ethers.ethers.providers.Web3Provider((_web3auth2 = web3auth) !== null && _web3auth2 !== void 0 && _web3auth2.provider ? web3auth.provider : web3auth);\n        const signer = ether.getSigner();\n        const values = await Promise.all([ether.getNetwork(), signer.getAddress()]);\n        const providerChainId = values[0].chainId;\n        _this.account = values[1].toLocaleLowerCase();\n        _this.chainId = `0x${providerChainId.toString(16)}`;\n        _this.provider = isSocialLogin ? ether : (_web3auth3 = web3auth) === null || _web3auth3 === void 0 ? void 0 : _web3auth3.provider;\n        _this.web3Instance = web3auth;\n\n        _this.subscribeToEvents(_this.provider);\n\n        return {\n          chainId: _this.chainId,\n          account: _this.account,\n          provider: _this.provider\n        };\n      } catch (_unused3) {\n        throw new Error('Could not connect via Web3Auth, error while authenticating');\n      }\n    });\n\n    _defineProperty(this, \"deactivate\", async () => {\n      this.unsubscribeToEvents(this.provider);\n\n      if (this.web3Instance) {\n        await this.web3Instance.logout();\n      }\n\n      this.account = null;\n      this.chainId = null;\n      this.provider = null;\n    });\n  }\n\n}\n\nexports.Web3Auth = Web3Auth;","map":{"version":3,"sources":["S:/final hackathon/nfi3/node_modules/moralis/lib/node/Web3Connector/Web3AuthConnector.js"],"names":["Object","defineProperty","exports","value","Web3Auth","_ethers","require","_verifyChainId","_interopRequireDefault","_AbstractWeb3Connector","obj","__esModule","default","_defineProperty","key","enumerable","configurable","writable","constructor","web3auth","Promise","resolve","reject","loginModal","on","visibility","Error","connect","then","catch","chainId","clientId","theme","appLogo","loginMethodsOrder","_require","_unused","_window","_window$Web3auth","window","Web3auth","ethChainConfig","chainNamespace","chainConfig","uiConfig","_unused2","initModal","provider","_web3auth","_web3auth2","_web3auth3","isSocialLogin","ether","ethers","providers","Web3Provider","signer","getSigner","values","all","getNetwork","getAddress","providerChainId","account","toLocaleLowerCase","toString","web3Instance","subscribeToEvents","_unused3","unsubscribeToEvents","logout"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,QAAR,GAAmB,KAAK,CAAxB;;AAEA,IAAIC,OAAO,GAAGC,OAAO,CAAC,QAAD,CAArB;;AAEA,IAAIC,cAAc,GAAGC,sBAAsB,CAACF,OAAO,CAAC,wBAAD,CAAR,CAA3C;;AAEA,IAAIG,sBAAsB,GAAGD,sBAAsB,CAACF,OAAO,CAAC,yBAAD,CAAR,CAAnD;;AAEA,SAASE,sBAAT,CAAgCE,GAAhC,EAAqC;AACnC,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AACnCE,IAAAA,OAAO,EAAEF;AAD0B,GAArC;AAGD;;AAED,SAASG,eAAT,CAAyBH,GAAzB,EAA8BI,GAA9B,EAAmCX,KAAnC,EAA0C;AACxC,MAAIW,GAAG,IAAIJ,GAAX,EAAgB;AACdV,IAAAA,MAAM,CAACC,cAAP,CAAsBS,GAAtB,EAA2BI,GAA3B,EAAgC;AAC9BX,MAAAA,KAAK,EAAEA,KADuB;AAE9BY,MAAAA,UAAU,EAAE,IAFkB;AAG9BC,MAAAA,YAAY,EAAE,IAHgB;AAI9BC,MAAAA,QAAQ,EAAE;AAJoB,KAAhC;AAMD,GAPD,MAOO;AACLP,IAAAA,GAAG,CAACI,GAAD,CAAH,GAAWX,KAAX;AACD;;AAED,SAAOO,GAAP;AACD;;AAED,MAAMN,QAAN,SAAuBK,sBAAsB,CAACG,OAA9C,CAAsD;AACpDM,EAAAA,WAAW,GAAU;AAAA;;AACnB,UAAM,YAAN,CADmB;AAAA;;AAGnBL,IAAAA,eAAe,CAAC,IAAD,EAAO,MAAP,EAAe,UAAf,CAAf;;AAEAA,IAAAA,eAAe,CAAC,IAAD,EAAO,SAAP,EAAkBM,QAAQ,IAAI;AAC3C,aAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,SAACH,QAAQ,IAAI;AACXA,UAAAA,QAAQ,CAACI,UAAT,CAAoBC,EAApB,CAAuB,kBAAvB,EAA2C,MAAMC,UAAN,IAAoB;AAC7D,gBAAI,CAACA,UAAL,EAAiB;AACfH,cAAAA,MAAM,CAAC,IAAII,KAAJ,CAAU,oCAAV,CAAD,CAAN;AACD;AACF,WAJD;AAKD,SAND,EAMGP,QANH;;AAQAA,QAAAA,QAAQ,CAACQ,OAAT,GAAmBC,IAAnB,CAAwBP,OAAxB,EAAiCQ,KAAjC,CAAuCP,MAAvC;AACD,OAVM,CAAP;AAWD,KAZc,CAAf;;AAcAT,IAAAA,eAAe,CAAC,IAAD,EAAO,UAAP,EAAmB,kBAMvB;AAAA,UAN8B;AACvCiB,QAAAA,OAAO,GAAG,KAD6B;AAEvCC,QAAAA,QAFuC;AAGvCC,QAAAA,KAHuC;AAIvCC,QAAAA,OAJuC;AAKvCC,QAAAA;AALuC,OAM9B,uEAAP,EAAO;;AACT;AACA,UAAI,CAACH,QAAL,EAAe;AACb,cAAM,IAAIL,KAAJ,CAAU,kDAAV,CAAN;AACD,OAJQ,CAIP;;;AAGF,UAAItB,QAAJ;;AAEA,UAAI;AACF,YAAI+B,QAAJ;;AAEA/B,QAAAA,QAAQ,GAAG,CAAC+B,QAAQ,GAAG7B,OAAO,CAAC,oBAAD,CAAnB,MAA+C,IAA/C,IAAuD6B,QAAQ,KAAK,KAAK,CAAzE,GAA6E,KAAK,CAAlF,GAAsFA,QAAQ,CAAC/B,QAA1G;AACD,OAJD,CAIE,OAAOgC,OAAP,EAAgB,CAAC;AAClB,OAdQ,CAcP;;;AAGF,UAAI,CAAChC,QAAL,EAAe;AACb,YAAIiC,OAAJ,EAAaC,gBAAb;;AAEAlC,QAAAA,QAAQ,GAAG,CAACiC,OAAO,GAAGE,MAAX,MAAuB,IAAvB,IAA+BF,OAAO,KAAK,KAAK,CAAhD,GAAoD,KAAK,CAAzD,GAA6D,CAACC,gBAAgB,GAAGD,OAAO,CAACG,QAA5B,MAA0C,IAA1C,IAAkDF,gBAAgB,KAAK,KAAK,CAA5E,GAAgF,KAAK,CAArF,GAAyFA,gBAAgB,CAAClC,QAAlL;AACD,OArBQ,CAqBP;;;AAGF,UAAI,CAACA,QAAL,EAAe;AACb,cAAM,IAAIsB,KAAJ,CAAU,oDAAV,CAAN;AACD,OA1BQ,CA0BP;;;AAGF,YAAMe,cAAc,GAAG;AACrBC,QAAAA,cAAc,EAAE,QADK;AAErBZ,QAAAA,OAAO,EAAE,CAAC,GAAGvB,cAAc,CAACK,OAAnB,EAA4BkB,OAA5B;AAFY,OAAvB,CA7BS,CAgCN;;AAEH,UAAIX,QAAJ;;AAEA,UAAI;AACFA,QAAAA,QAAQ,GAAG,IAAIf,QAAJ,CAAa;AACtBuC,UAAAA,WAAW,EAAEF,cADS;AAEtBG,UAAAA,QAAQ,EAAE;AACRZ,YAAAA,KAAK,EAAEA,KAAK,KAAK,IAAV,IAAkBA,KAAK,KAAK,KAAK,CAAjC,GAAqCA,KAArC,GAA6C,MAD5C;AAERC,YAAAA,OAAO,EAAEA,OAAO,KAAK,IAAZ,IAAoBA,OAAO,KAAK,KAAK,CAArC,GAAyCA,OAAzC,GAAmD,oEAFpD;AAGRC,YAAAA;AAHQ,WAFY;AAOtBH,UAAAA,QAAQ,EAAEA;AAPY,SAAb,CAAX;AASD,OAVD,CAUE,OAAOc,QAAP,EAAiB,CAAC;AACnB;;AAED,UAAI,CAAC1B,QAAL,EAAe;AACb,cAAM,IAAIO,KAAJ,CAAU,oEAAV,CAAN;AACD,OAnDQ,CAmDP;;;AAGF,YAAMP,QAAQ,CAAC2B,SAAT,EAAN;AACA,UAAIC,QAAQ,GAAG,IAAf;AACAA,MAAAA,QAAQ,GAAG,MAAM,KAAI,CAACpB,OAAL,CAAaR,QAAb,CAAjB;;AAEA,UAAI,CAAC4B,QAAL,EAAe;AACb,cAAM,IAAIrB,KAAJ,CAAU,iEAAV,CAAN;AACD,OA5DQ,CA4DP;;;AAGF,UAAI;AACF,YAAIsB,SAAJ,EAAeC,UAAf,EAA2BC,UAA3B;;AAEA,cAAMC,aAAa,GAAG,CAACH,SAAS,GAAG7B,QAAb,MAA2B,IAA3B,IAAmC6B,SAAS,KAAK,KAAK,CAAtD,IAA2DA,SAAS,CAACD,QAArE,GAAgF,KAAhF,GAAwF,IAA9G;AACA,cAAMK,KAAK,GAAG,IAAI/C,OAAO,CAACgD,MAAR,CAAeC,SAAf,CAAyBC,YAA7B,CAA0C,CAACN,UAAU,GAAG9B,QAAd,MAA4B,IAA5B,IAAoC8B,UAAU,KAAK,KAAK,CAAxD,IAA6DA,UAAU,CAACF,QAAxE,GAAmF5B,QAAQ,CAAC4B,QAA5F,GAAuG5B,QAAjJ,CAAd;AACA,cAAMqC,MAAM,GAAGJ,KAAK,CAACK,SAAN,EAAf;AACA,cAAMC,MAAM,GAAG,MAAMtC,OAAO,CAACuC,GAAR,CAAY,CAACP,KAAK,CAACQ,UAAN,EAAD,EAAqBJ,MAAM,CAACK,UAAP,EAArB,CAAZ,CAArB;AACA,cAAMC,eAAe,GAAGJ,MAAM,CAAC,CAAD,CAAN,CAAU5B,OAAlC;AACA,QAAA,KAAI,CAACiC,OAAL,GAAeL,MAAM,CAAC,CAAD,CAAN,CAAUM,iBAAV,EAAf;AACA,QAAA,KAAI,CAAClC,OAAL,GAAgB,KAAIgC,eAAe,CAACG,QAAhB,CAAyB,EAAzB,CAA6B,EAAjD;AACA,QAAA,KAAI,CAAClB,QAAL,GAAgBI,aAAa,GAAGC,KAAH,GAAW,CAACF,UAAU,GAAG/B,QAAd,MAA4B,IAA5B,IAAoC+B,UAAU,KAAK,KAAK,CAAxD,GAA4D,KAAK,CAAjE,GAAqEA,UAAU,CAACH,QAAxH;AACA,QAAA,KAAI,CAACmB,YAAL,GAAoB/C,QAApB;;AACA,QAAA,KAAI,CAACgD,iBAAL,CAAuB,KAAI,CAACpB,QAA5B;;AACA,eAAO;AACLjB,UAAAA,OAAO,EAAE,KAAI,CAACA,OADT;AAELiC,UAAAA,OAAO,EAAE,KAAI,CAACA,OAFT;AAGLhB,UAAAA,QAAQ,EAAE,KAAI,CAACA;AAHV,SAAP;AAKD,OAlBD,CAkBE,OAAOqB,QAAP,EAAiB;AACjB,cAAM,IAAI1C,KAAJ,CAAU,4DAAV,CAAN;AACD;AACF,KA1Fc,CAAf;;AA4FAb,IAAAA,eAAe,CAAC,IAAD,EAAO,YAAP,EAAqB,YAAY;AAC9C,WAAKwD,mBAAL,CAAyB,KAAKtB,QAA9B;;AAEA,UAAI,KAAKmB,YAAT,EAAuB;AACrB,cAAM,KAAKA,YAAL,CAAkBI,MAAlB,EAAN;AACD;;AAED,WAAKP,OAAL,GAAe,IAAf;AACA,WAAKjC,OAAL,GAAe,IAAf;AACA,WAAKiB,QAAL,GAAgB,IAAhB;AACD,KAVc,CAAf;AAWD;;AA3HmD;;AA+HtD7C,OAAO,CAACE,QAAR,GAAmBA,QAAnB","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Web3Auth = void 0;\n\nvar _ethers = require(\"ethers\");\n\nvar _verifyChainId = _interopRequireDefault(require(\"../utils/verifyChainId\"));\n\nvar _AbstractWeb3Connector = _interopRequireDefault(require(\"./AbstractWeb3Connector\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nclass Web3Auth extends _AbstractWeb3Connector.default {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"type\", 'web3Auth');\n\n    _defineProperty(this, \"connect\", web3auth => {\n      return new Promise((resolve, reject) => {\n        (web3auth => {\n          web3auth.loginModal.on('MODAL_VISIBILITY', async visibility => {\n            if (!visibility) {\n              reject(new Error('Web3Auth: User closed login modal.'));\n            }\n          });\n        })(web3auth);\n\n        web3auth.connect().then(resolve).catch(reject);\n      });\n    });\n\n    _defineProperty(this, \"activate\", async ({\n      chainId = '0x1',\n      clientId,\n      theme,\n      appLogo,\n      loginMethodsOrder\n    } = {}) => {\n      // Checking that all params are given\n      if (!clientId) {\n        throw new Error('\"clientId\" not provided, please provide clientId');\n      } // Initalizing Web3Auth and getting constants\n\n\n      let Web3Auth;\n\n      try {\n        var _require;\n\n        Web3Auth = (_require = require('@web3auth/web3auth')) === null || _require === void 0 ? void 0 : _require.Web3Auth;\n      } catch (_unused) {// Do Nothing Individual Checks are done below\n      } // Check if user is using CDN to import\n\n\n      if (!Web3Auth) {\n        var _window, _window$Web3auth;\n\n        Web3Auth = (_window = window) === null || _window === void 0 ? void 0 : (_window$Web3auth = _window.Web3auth) === null || _window$Web3auth === void 0 ? void 0 : _window$Web3auth.Web3Auth;\n      } // Error checking for if library is not installed\n\n\n      if (!Web3Auth) {\n        throw new Error('\"@web3auth/web3auth\" not installed, please install');\n      } // Build config\n\n\n      const ethChainConfig = {\n        chainNamespace: 'eip155',\n        chainId: (0, _verifyChainId.default)(chainId)\n      }; // Build Web3Auth\n\n      let web3auth;\n\n      try {\n        web3auth = new Web3Auth({\n          chainConfig: ethChainConfig,\n          uiConfig: {\n            theme: theme !== null && theme !== void 0 ? theme : 'dark',\n            appLogo: appLogo !== null && appLogo !== void 0 ? appLogo : 'https://moralis.io/wp-content/uploads/2021/05/moralisWhiteLogo.svg',\n            loginMethodsOrder\n          },\n          clientId: clientId\n        });\n      } catch (_unused2) {// Do Nothing error checked below\n      }\n\n      if (!web3auth) {\n        throw new Error('Could not connect via Web3Auth, error during initializing Web3Auth');\n      } // Authenticate\n\n\n      await web3auth.initModal();\n      let provider = null;\n      provider = await this.connect(web3auth);\n\n      if (!provider) {\n        throw new Error('Could not connect via Web3Auth, error in connecting to provider');\n      } // Gather User data\n\n\n      try {\n        var _web3auth, _web3auth2, _web3auth3;\n\n        const isSocialLogin = (_web3auth = web3auth) !== null && _web3auth !== void 0 && _web3auth.provider ? false : true;\n        const ether = new _ethers.ethers.providers.Web3Provider((_web3auth2 = web3auth) !== null && _web3auth2 !== void 0 && _web3auth2.provider ? web3auth.provider : web3auth);\n        const signer = ether.getSigner();\n        const values = await Promise.all([ether.getNetwork(), signer.getAddress()]);\n        const providerChainId = values[0].chainId;\n        this.account = values[1].toLocaleLowerCase();\n        this.chainId = `0x${providerChainId.toString(16)}`;\n        this.provider = isSocialLogin ? ether : (_web3auth3 = web3auth) === null || _web3auth3 === void 0 ? void 0 : _web3auth3.provider;\n        this.web3Instance = web3auth;\n        this.subscribeToEvents(this.provider);\n        return {\n          chainId: this.chainId,\n          account: this.account,\n          provider: this.provider\n        };\n      } catch (_unused3) {\n        throw new Error('Could not connect via Web3Auth, error while authenticating');\n      }\n    });\n\n    _defineProperty(this, \"deactivate\", async () => {\n      this.unsubscribeToEvents(this.provider);\n\n      if (this.web3Instance) {\n        await this.web3Instance.logout();\n      }\n\n      this.account = null;\n      this.chainId = null;\n      this.provider = null;\n    });\n  }\n\n}\n\nexports.Web3Auth = Web3Auth;"]},"metadata":{},"sourceType":"script"}